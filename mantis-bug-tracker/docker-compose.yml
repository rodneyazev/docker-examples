services:
  mantis:
    image: okainov/mantisbt:latest
    container_name: mantis
    ports:
      - "8989:80"
    environment:
      MANTIS_ENABLE_ADMIN: 1
      # Set master salt, typically can be generated by `cat /dev/urandom | head -c 64 | base64`
      #- MASTER_SALT=
      # Set base email settings. For more detailed configuration (i.e. SMTP) you'll need to add own config file
      EMAIL_WEBMASTER: webmaster@localhost
      EMAIL_FROM: webmaster@localhost
      EMAIL_RETURN_PATH: webmaster@localhost
      # Uncomment only if modified from default values
      #- MYSQL_HOST=db
      #- MYSQL_DATABASE=bugtracker
      #- MYSQL_USER=mantis
      #- MYSQL_PASSWORD=mantis
    depends_on:
      - db
    restart: unless-stopped
  db:
    image: mysql:latest
    container_name: "mysql"
    hostname: "mysql"
    # restart: always
    environment:
      # Default DB values
      - MYSQL_ROOT_PASSWORD=root
      - MYSQL_DATABASE=bugtracker
      - MYSQL_USER=mantis
      - MYSQL_PASSWORD=mantis
    ports:
      - "3306:3306"
    volumes:
      - db:/var/lib/mysql
      - .data/init.sql:/docker-entrypoint-initdb.d/init.sql
    command: ['mysqld', '--character-set-server=utf8mb4', '--collation-server=utf8mb4_unicode_ci']
volumes:
  db:
